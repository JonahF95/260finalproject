<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Capstone Project: BST 260: Final Report: BST 260 Capstone</title>

  <meta property="description" itemprop="description" content="Report on the use of linear models in predicting DNA methylation expression from&#10;quality control metrics"/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-12-20"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-12-20"/>
  <meta name="article:author" content="Jonah Fisher"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Capstone Project: BST 260: Final Report: BST 260 Capstone"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Report on the use of linear models in predicting DNA methylation expression from&#10;quality control metrics"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Capstone Project: BST 260"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Capstone Project: BST 260: Final Report: BST 260 Capstone"/>
  <meta property="twitter:description" content="Report on the use of linear models in predicting DNA methylation expression from&#10;quality control metrics"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Final Report: BST 260 Capstone"]},{"type":"character","attributes":{},"value":["Report on the use of linear models in predicting DNA methylation expression from\nquality control metrics\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url"]}},"value":[{"type":"character","attributes":{},"value":["Jonah Fisher"]},{"type":"character","attributes":{},"value":["https://github.com/JonahF95"]},{"type":"character","attributes":{},"value":["Harvard T.H. Chan Department of Biostatistics"]},{"type":"character","attributes":{},"value":["https://www.hsph.harvard.edu/biostatistics/"]}]}]},{"type":"character","attributes":{},"value":["2022-12-20"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_depth","toc_float","css","self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[6]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["toc-styles.css"]},{"type":"logical","attributes":{},"value":[false]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->

  <link rel="stylesheet" href="toc-styles.css" type="text/css"/>

</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Final Report: BST 260 Capstone","description":"Report on the use of linear models in predicting DNA methylation expression from\nquality control metrics","authors":[{"author":"Jonah Fisher","authorURL":"https://github.com/JonahF95","affiliation":"Harvard T.H. Chan Department of Biostatistics","affiliationURL":"https://www.hsph.harvard.edu/biostatistics/","orcidID":""}],"publishedDate":"2022-12-20T00:00:00.000-05:00","citationText":"Fisher, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="index.html" class="title">Capstone Project: BST 260</a>
</div>
<div class="nav-right">
<a href="writeup.html">Final Report</a>
<a href="getdata.html">Data Acquisition</a>
<a href="qc.html">Quality Control</a>
<a href="analysis.html">Primary Analysis</a>
<a href="https://github.com/JonahF95">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Final Report: BST 260 Capstone</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Report on the use of linear models in predicting DNA methylation expression from
quality control metrics</p></p>
</div>

<div class="d-byline">
  Jonah Fisher <a href="https://github.com/JonahF95" class="uri">https://github.com/JonahF95</a> (Harvard T.H. Chan Department of Biostatistics)<a href="https://www.hsph.harvard.edu/biostatistics/" class="uri">https://www.hsph.harvard.edu/biostatistics/</a>
  
<br/>2022-12-20
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#results" id="toc-results">Results</a></li>
<li><a href="#conclusion" id="toc-conclusion">Conclusion</a></li>
<li><a href="#appendix" id="toc-appendix">Appendix</a>
<ul>
<li><a href="#figures" id="toc-figures">Figures</a></li>
<li><a href="#code" id="toc-code">Code</a></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul></li>
</ul>
</nav>
</div>
<h1 id="introduction">Introduction</h1>
<p>From prior work experience I had learned of DNA methylation expression data. I do
not have much of any experience with publically available data and thought that investigating
the relationship between quality control measures and expression data could provide
useful experience in web scraping, data wrangling, and data analysis. There
are numerous quality control measurements as part of expression data and I thought
that an interesting question could be to explore machine learning approaches to
predicting methylation expression levels from the QC data. Several normalization
and adjustment methods (including at least one popular one that included Professor Irizarry
as a coauthor)
to correct for technical artifacts in DNAm have been published already that use
these control probes (Triche et al.2013). A set of technical replicate sample pairs were
downloaded from the publically available Gene Expression Omnibus data (GEO)
data repository (Tan et al.2014). There is the potential that this machine
learning approach can be used for normalization in a manner similar to the aforementioned
packages or for imputation in a manner such as knn imputation. Taking the project
to that conclusion is beyond the scope of what I will be able to do for this
class but I am planning to continue on in the future to make an attempt at this normalization and imputation.
At this point in the project I will look at linear regression to use principal
components from control probe expression to predict mean centered expression
values for various probes. This was chosen as it forms a good stepping stone before
delving into more complicated methodologies. The future aims will include a variety of more
advance machine learning approaches.
As part of data wrangling and exploratory data analysis QC information from
this expression data was compiled into a data table (Table 2) and quality control
checks such as principal component analysis against technical artifacts like plating
(Figure 2) were investigated.
In summary, the general motivating question behind this project is whether
machine learning applied to DNAm quality control metrics can be useful in predicting,
imputing, and normalizing expression data.</p>
<h1 id="results">Results</h1>
<p>Data were aggregated from scratch from a public repository GEO <img src="https://www.ncbi.nlm.nih.gov/geo/" alt="Gene Expression Omnibus" />. A set of data on Danish twins was chosen
and 15 samples were downloaded from the website (Tan et al.2014). This dataset
was chosen because it has readily available raw files (idats) which include
non preprocessed expression data which was necessary for this report. The 15 samples
reflected samples for which there were technical replicates which can facilitate
assessment of normalization efficacy in how similar the expression data of the
pairs becomes. Extensive data wrangling was necessary to identify the technical replicates,
download their data, acquire phenotype information (just on self reported sex for QC),
and to preprocess the methylation data. Web scraping from the series website (Image 1)
involved reading lines from the html page with <strong>htmltools</strong> and searching for regex
matches to underline followed by letters A-E which were used to mark technical replicate
pairs. The GSM ID for these samples was extracted, saved to an initial data table (Table 1), and looped
through downloading via ftp the appropriate .idat files. For a QC step involving
checking reported and DNA methylation sex the <strong>readLines</strong> function was used
for each of the samples html page and regex was used to extract the reported sex.</p>
<p>Quality control for the expression data primarily followed the pipeline set up
by the authors of the <strong>ewasools</strong> package (Heiss &amp; Just 2018). Raw idats were
read in with the <strong>read_idats</strong> function. Reported sex was compared to DNA
methylation expression levels from the sex chromosome probes with intent
to identify possible misplates of which there were none (Figure 1). Technical noise in
background signal was assessed with a metric known as <em>Detection P</em> which showed
reasonable quality of assay for all samples. Sample cell proportion estimates and principal
components of expression data were created to explore primary sources of variation
in the expression data (Figure 2) and quality control information was summarized
for each sample and finally, expression data was converted to a log-transformed
state for use in the coming analyses.</p>
<p>The analysis performed looked at using a linear regression model to predict
DNA methylation expression. Expression data was mean centered across samples
and therefore the outcome was degree of increase or decrease in methylation as
compared to the average across samples. For reasons memory primarily as well
as limited availability of technical replicate samples, there were
only 15 samples included in the analysis and therefore the dimensions of predictors
were cut down. A total of 2550 methylation probes were put into principal component
analysis with the first 10 components being used as predictors. Since there are
over 400,000 different sites to look at a random sample of 1000 methylation sites
was selected for purposes of computation time and memory space,
and the outputs of the linear model on each site was compared. PCs
1, 2, and 5 all had consistently negative effects on mean centered methylation,
with PCs 3, 6, 7 having consistently positive effects as assessed with t-tests (Figure 3).
R squared values were far higher than expected with the 10 PCs of the control
probes with 950 (95%) of the sites showing an r-squared value of &gt;= 0.59 (Figure 4).
The RMSE also fared up favorably and was quite small with the average standard
deviation of the fitted values being 0.39 and the average of the room mean
squared errors being 0.14 (Figure 5)</p>
<h1 id="conclusion">Conclusion</h1>
<p>In short, the low RMSEs and high R squareds provide promising initial feedback
on the merit of this project. The aim was to investigate the relationship
between quality control metrics from DNA methylation microarrays, and the expression
levels of the samples. The public dataset GEO was accessed for a set of technical
replicate pairs. Exploratory data analysis and quality control revealed no major
issues in the underlying data. A log transformed and sample mean centered expression
matrix was created and expression levels were predicted from principal components
of quality control metrics. Given the success of the linear modeling there is
good merit in continuing the project while addressing some limitations of the current
methods and data. First, a higher sample count will be helpful for statistical power.
Second, with greater analysis time it will be possible to look at all 485,000
methylation sites rather than a random sample of 1000 of them. Third, more advanced
machine learning methods such as knn, random forest, and neural networks may
provide even better predictive power. Fourth, the utility of this approach in
normalization and imputation can be assessed through both minimizing technical replicate
error rates and perhaps improving the predictive power of poly-epigenetic scores.</p>
<h1 id="appendix">Appendix</h1>
<h2 id="figures">Figures</h2>
<figure>
<img src="geosite.png" alt="Image 1" />
<figcaption aria-hidden="true">Image 1</figcaption>
</figure>
<p><strong>Table 1: Initial sample information data table</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div id="aaldsdrgnh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#aaldsdrgnh .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#aaldsdrgnh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aaldsdrgnh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#aaldsdrgnh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#aaldsdrgnh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#aaldsdrgnh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aaldsdrgnh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aaldsdrgnh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#aaldsdrgnh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#aaldsdrgnh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#aaldsdrgnh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#aaldsdrgnh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#aaldsdrgnh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#aaldsdrgnh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#aaldsdrgnh .gt_from_md > :first-child {
  margin-top: 0;
}

#aaldsdrgnh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#aaldsdrgnh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#aaldsdrgnh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#aaldsdrgnh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#aaldsdrgnh .gt_row_group_first td {
  border-top-width: 2px;
}

#aaldsdrgnh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aaldsdrgnh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#aaldsdrgnh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#aaldsdrgnh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aaldsdrgnh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aaldsdrgnh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#aaldsdrgnh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#aaldsdrgnh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aaldsdrgnh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aaldsdrgnh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aaldsdrgnh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aaldsdrgnh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aaldsdrgnh .gt_left {
  text-align: left;
}

#aaldsdrgnh .gt_center {
  text-align: center;
}

#aaldsdrgnh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#aaldsdrgnh .gt_font_normal {
  font-weight: normal;
}

#aaldsdrgnh .gt_font_bold {
  font-weight: bold;
}

#aaldsdrgnh .gt_font_italic {
  font-style: italic;
}

#aaldsdrgnh .gt_super {
  font-size: 65%;
}

#aaldsdrgnh .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#aaldsdrgnh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#aaldsdrgnh .gt_indent_1 {
  text-indent: 5px;
}

#aaldsdrgnh .gt_indent_2 {
  text-indent: 10px;
}

#aaldsdrgnh .gt_indent_3 {
  text-indent: 15px;
}

#aaldsdrgnh .gt_indent_4 {
  text-indent: 20px;
}

#aaldsdrgnh .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="id">id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="num">num</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="orig">orig</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="id" class="gt_row gt_left">GSM1506284</td>
<td headers="num" class="gt_row gt_right">2032</td>
<td headers="orig" class="gt_row gt_left">A</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506587</td>
<td headers="num" class="gt_row gt_right">2032</td>
<td headers="orig" class="gt_row gt_left">B</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506278</td>
<td headers="num" class="gt_row gt_right">2033</td>
<td headers="orig" class="gt_row gt_left">A</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506581</td>
<td headers="num" class="gt_row gt_right">2033</td>
<td headers="orig" class="gt_row gt_left">B</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506342</td>
<td headers="num" class="gt_row gt_right">2041</td>
<td headers="orig" class="gt_row gt_left">A</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506586</td>
<td headers="num" class="gt_row gt_right">2041</td>
<td headers="orig" class="gt_row gt_left">B</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506336</td>
<td headers="num" class="gt_row gt_right">2042</td>
<td headers="orig" class="gt_row gt_left">A</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506580</td>
<td headers="num" class="gt_row gt_right">2042</td>
<td headers="orig" class="gt_row gt_left">B</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506333</td>
<td headers="num" class="gt_row gt_right">2085</td>
<td headers="orig" class="gt_row gt_left">A</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506438</td>
<td headers="num" class="gt_row gt_right">2085</td>
<td headers="orig" class="gt_row gt_left">B</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506500</td>
<td headers="num" class="gt_row gt_right">2085</td>
<td headers="orig" class="gt_row gt_left">C</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506560</td>
<td headers="num" class="gt_row gt_right">2085</td>
<td headers="orig" class="gt_row gt_left">D</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506327</td>
<td headers="num" class="gt_row gt_right">2086</td>
<td headers="orig" class="gt_row gt_left">A</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506432</td>
<td headers="num" class="gt_row gt_right">2086</td>
<td headers="orig" class="gt_row gt_left">B</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506494</td>
<td headers="num" class="gt_row gt_right">2086</td>
<td headers="orig" class="gt_row gt_left">C</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<p><strong>Figure 1: Reported sex with sex chromosome expression levels</strong></p>
<figure>
<img src="sexcheck.png" alt="Figure 1" />
<figcaption aria-hidden="true">Figure 1</figcaption>
</figure>
<p><strong>Figure 2: Principal components of expression data with sample slide</strong></p>
<figure>
<img src="pcs_by_slide.png" alt="Figure 2" />
<figcaption aria-hidden="true">Figure 2</figcaption>
</figure>
<p><strong>Table 2: Quality control augmented sample data table</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div id="eavyowriqr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#eavyowriqr .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#eavyowriqr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eavyowriqr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#eavyowriqr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#eavyowriqr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#eavyowriqr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eavyowriqr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eavyowriqr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#eavyowriqr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#eavyowriqr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#eavyowriqr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#eavyowriqr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#eavyowriqr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#eavyowriqr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#eavyowriqr .gt_from_md > :first-child {
  margin-top: 0;
}

#eavyowriqr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#eavyowriqr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#eavyowriqr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#eavyowriqr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#eavyowriqr .gt_row_group_first td {
  border-top-width: 2px;
}

#eavyowriqr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eavyowriqr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#eavyowriqr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#eavyowriqr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eavyowriqr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eavyowriqr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#eavyowriqr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#eavyowriqr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eavyowriqr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eavyowriqr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eavyowriqr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eavyowriqr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eavyowriqr .gt_left {
  text-align: left;
}

#eavyowriqr .gt_center {
  text-align: center;
}

#eavyowriqr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#eavyowriqr .gt_font_normal {
  font-weight: normal;
}

#eavyowriqr .gt_font_bold {
  font-weight: bold;
}

#eavyowriqr .gt_font_italic {
  font-style: italic;
}

#eavyowriqr .gt_super {
  font-size: 65%;
}

#eavyowriqr .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#eavyowriqr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#eavyowriqr .gt_indent_1 {
  text-indent: 5px;
}

#eavyowriqr .gt_indent_2 {
  text-indent: 10px;
}

#eavyowriqr .gt_indent_3 {
  text-indent: 15px;
}

#eavyowriqr .gt_indent_4 {
  text-indent: 20px;
}

#eavyowriqr .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="id">id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="num">num</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="sex">sex</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="x">x</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="y">y</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="missing">missing</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="u">u</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="m">m</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="cellpc">cellpc</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="PC1">PC1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="PC2">PC2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="PC3">PC3</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="PC4">PC4</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="PC5">PC5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="slide">slide</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="id" class="gt_row gt_left">GSM1506278</td>
<td headers="num" class="gt_row gt_left">2033_A</td>
<td headers="sex" class="gt_row gt_left">f</td>
<td headers="x" class="gt_row gt_right">1.1518299</td>
<td headers="y" class="gt_row gt_right">0.09466627</td>
<td headers="missing" class="gt_row gt_right">0.0013787466</td>
<td headers="u" class="gt_row gt_right">11.55219</td>
<td headers="m" class="gt_row gt_right">12.23182</td>
<td headers="cellpc" class="gt_row gt_right">-0.092989625</td>
<td headers="PC1" class="gt_row gt_right">-28.125696</td>
<td headers="PC2" class="gt_row gt_right">4.083327</td>
<td headers="PC3" class="gt_row gt_right">11.2421670</td>
<td headers="PC4" class="gt_row gt_right">10.719038</td>
<td headers="PC5" class="gt_row gt_right">6.218797</td>
<td headers="slide" class="gt_row gt_center">7310440017</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506284</td>
<td headers="num" class="gt_row gt_left">2032_A</td>
<td headers="sex" class="gt_row gt_left">f</td>
<td headers="x" class="gt_row gt_right">1.1353356</td>
<td headers="y" class="gt_row gt_right">0.09124004</td>
<td headers="missing" class="gt_row gt_right">0.0012189751</td>
<td headers="u" class="gt_row gt_right">11.73556</td>
<td headers="m" class="gt_row gt_right">12.49185</td>
<td headers="cellpc" class="gt_row gt_right">0.143516536</td>
<td headers="PC1" class="gt_row gt_right">-29.369990</td>
<td headers="PC2" class="gt_row gt_right">-6.749944</td>
<td headers="PC3" class="gt_row gt_right">4.6937207</td>
<td headers="PC4" class="gt_row gt_right">-12.465509</td>
<td headers="PC5" class="gt_row gt_right">-5.658340</td>
<td headers="slide" class="gt_row gt_center">7310440017</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506327</td>
<td headers="num" class="gt_row gt_left">2086_A</td>
<td headers="sex" class="gt_row gt_left">m</td>
<td headers="x" class="gt_row gt_right">0.7146836</td>
<td headers="y" class="gt_row gt_right">0.88843373</td>
<td headers="missing" class="gt_row gt_right">0.0008205703</td>
<td headers="u" class="gt_row gt_right">11.35590</td>
<td headers="m" class="gt_row gt_right">12.12024</td>
<td headers="cellpc" class="gt_row gt_right">-0.184191796</td>
<td headers="PC1" class="gt_row gt_right">14.138370</td>
<td headers="PC2" class="gt_row gt_right">4.090498</td>
<td headers="PC3" class="gt_row gt_right">16.5603359</td>
<td headers="PC4" class="gt_row gt_right">3.710783</td>
<td headers="PC5" class="gt_row gt_right">-3.787220</td>
<td headers="slide" class="gt_row gt_center">7310440025</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506333</td>
<td headers="num" class="gt_row gt_left">2085_A</td>
<td headers="sex" class="gt_row gt_left">m</td>
<td headers="x" class="gt_row gt_right">0.7364625</td>
<td headers="y" class="gt_row gt_right">0.87503660</td>
<td headers="missing" class="gt_row gt_right">0.0006177760</td>
<td headers="u" class="gt_row gt_right">11.63072</td>
<td headers="m" class="gt_row gt_right">12.39366</td>
<td headers="cellpc" class="gt_row gt_right">-0.002865969</td>
<td headers="PC1" class="gt_row gt_right">12.378938</td>
<td headers="PC2" class="gt_row gt_right">-1.478842</td>
<td headers="PC3" class="gt_row gt_right">12.0465913</td>
<td headers="PC4" class="gt_row gt_right">-4.157806</td>
<td headers="PC5" class="gt_row gt_right">1.830524</td>
<td headers="slide" class="gt_row gt_center">7310440025</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506336</td>
<td headers="num" class="gt_row gt_left">2042_A</td>
<td headers="sex" class="gt_row gt_left">m</td>
<td headers="x" class="gt_row gt_right">0.7575678</td>
<td headers="y" class="gt_row gt_right">0.82378922</td>
<td headers="missing" class="gt_row gt_right">0.0015529367</td>
<td headers="u" class="gt_row gt_right">11.01053</td>
<td headers="m" class="gt_row gt_right">11.71253</td>
<td headers="cellpc" class="gt_row gt_right">0.155476409</td>
<td headers="PC1" class="gt_row gt_right">5.075693</td>
<td headers="PC2" class="gt_row gt_right">-30.285978</td>
<td headers="PC3" class="gt_row gt_right">6.1288331</td>
<td headers="PC4" class="gt_row gt_right">11.491317</td>
<td headers="PC5" class="gt_row gt_right">-8.554621</td>
<td headers="slide" class="gt_row gt_center">6929742044</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506342</td>
<td headers="num" class="gt_row gt_left">2041_A</td>
<td headers="sex" class="gt_row gt_left">m</td>
<td headers="x" class="gt_row gt_right">0.7526878</td>
<td headers="y" class="gt_row gt_right">0.84589810</td>
<td headers="missing" class="gt_row gt_right">0.0007426753</td>
<td headers="u" class="gt_row gt_right">11.09606</td>
<td headers="m" class="gt_row gt_right">11.86457</td>
<td headers="cellpc" class="gt_row gt_right">0.256292588</td>
<td headers="PC1" class="gt_row gt_right">2.599622</td>
<td headers="PC2" class="gt_row gt_right">-34.961119</td>
<td headers="PC3" class="gt_row gt_right">2.2637859</td>
<td headers="PC4" class="gt_row gt_right">-4.177470</td>
<td headers="PC5" class="gt_row gt_right">7.936470</td>
<td headers="slide" class="gt_row gt_center">6929742044</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506432</td>
<td headers="num" class="gt_row gt_left">2086_B</td>
<td headers="sex" class="gt_row gt_left">m</td>
<td headers="x" class="gt_row gt_right">0.7582605</td>
<td headers="y" class="gt_row gt_right">0.85375128</td>
<td headers="missing" class="gt_row gt_right">0.0005172920</td>
<td headers="u" class="gt_row gt_right">11.47421</td>
<td headers="m" class="gt_row gt_right">11.86186</td>
<td headers="cellpc" class="gt_row gt_right">-0.197073034</td>
<td headers="PC1" class="gt_row gt_right">15.352228</td>
<td headers="PC2" class="gt_row gt_right">17.084571</td>
<td headers="PC3" class="gt_row gt_right">0.8077959</td>
<td headers="PC4" class="gt_row gt_right">1.713707</td>
<td headers="PC5" class="gt_row gt_right">-1.302796</td>
<td headers="slide" class="gt_row gt_center">7497398117</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506438</td>
<td headers="num" class="gt_row gt_left">2085_B</td>
<td headers="sex" class="gt_row gt_left">m</td>
<td headers="x" class="gt_row gt_right">0.7613465</td>
<td headers="y" class="gt_row gt_right">0.86392827</td>
<td headers="missing" class="gt_row gt_right">0.0004940319</td>
<td headers="u" class="gt_row gt_right">11.44501</td>
<td headers="m" class="gt_row gt_right">11.88950</td>
<td headers="cellpc" class="gt_row gt_right">-0.021798976</td>
<td headers="PC1" class="gt_row gt_right">13.028874</td>
<td headers="PC2" class="gt_row gt_right">9.425374</td>
<td headers="PC3" class="gt_row gt_right">-1.2676588</td>
<td headers="PC4" class="gt_row gt_right">-4.449115</td>
<td headers="PC5" class="gt_row gt_right">1.739016</td>
<td headers="slide" class="gt_row gt_center">7497398117</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506494</td>
<td headers="num" class="gt_row gt_left">2086_C</td>
<td headers="sex" class="gt_row gt_left">m</td>
<td headers="x" class="gt_row gt_right">0.7741964</td>
<td headers="y" class="gt_row gt_right">0.85688591</td>
<td headers="missing" class="gt_row gt_right">0.0004700865</td>
<td headers="u" class="gt_row gt_right">11.93848</td>
<td headers="m" class="gt_row gt_right">12.20701</td>
<td headers="cellpc" class="gt_row gt_right">-0.189321526</td>
<td headers="PC1" class="gt_row gt_right">15.472260</td>
<td headers="PC2" class="gt_row gt_right">16.531708</td>
<td headers="PC3" class="gt_row gt_right">-1.3179971</td>
<td headers="PC4" class="gt_row gt_right">3.518120</td>
<td headers="PC5" class="gt_row gt_right">-2.859461</td>
<td headers="slide" class="gt_row gt_center">7310440129</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506500</td>
<td headers="num" class="gt_row gt_left">2085_C</td>
<td headers="sex" class="gt_row gt_left">m</td>
<td headers="x" class="gt_row gt_right">0.7619505</td>
<td headers="y" class="gt_row gt_right">0.89337599</td>
<td headers="missing" class="gt_row gt_right">0.0003648554</td>
<td headers="u" class="gt_row gt_right">11.84510</td>
<td headers="m" class="gt_row gt_right">12.51890</td>
<td headers="cellpc" class="gt_row gt_right">-0.014911261</td>
<td headers="PC1" class="gt_row gt_right">12.942875</td>
<td headers="PC2" class="gt_row gt_right">3.750229</td>
<td headers="PC3" class="gt_row gt_right">4.5560022</td>
<td headers="PC4" class="gt_row gt_right">-5.906554</td>
<td headers="PC5" class="gt_row gt_right">2.906799</td>
<td headers="slide" class="gt_row gt_center">7310440129</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506560</td>
<td headers="num" class="gt_row gt_left">2085_D</td>
<td headers="sex" class="gt_row gt_left">m</td>
<td headers="x" class="gt_row gt_right">0.7613688</td>
<td headers="y" class="gt_row gt_right">0.87460599</td>
<td headers="missing" class="gt_row gt_right">0.0004115715</td>
<td headers="u" class="gt_row gt_right">11.84038</td>
<td headers="m" class="gt_row gt_right">12.43567</td>
<td headers="cellpc" class="gt_row gt_right">-0.019218078</td>
<td headers="PC1" class="gt_row gt_right">13.147962</td>
<td headers="PC2" class="gt_row gt_right">6.450182</td>
<td headers="PC3" class="gt_row gt_right">2.3962606</td>
<td headers="PC4" class="gt_row gt_right">-5.203408</td>
<td headers="PC5" class="gt_row gt_right">2.459210</td>
<td headers="slide" class="gt_row gt_center">7310440111</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506580</td>
<td headers="num" class="gt_row gt_left">2042_B</td>
<td headers="sex" class="gt_row gt_left">m</td>
<td headers="x" class="gt_row gt_right">0.7605642</td>
<td headers="y" class="gt_row gt_right">0.78028527</td>
<td headers="missing" class="gt_row gt_right">0.0002863794</td>
<td headers="u" class="gt_row gt_right">12.20976</td>
<td headers="m" class="gt_row gt_right">12.49336</td>
<td headers="cellpc" class="gt_row gt_right">0.074717897</td>
<td headers="PC1" class="gt_row gt_right">5.082215</td>
<td headers="PC2" class="gt_row gt_right">-2.367245</td>
<td headers="PC3" class="gt_row gt_right">-25.6694142</td>
<td headers="PC4" class="gt_row gt_right">7.137526</td>
<td headers="PC5" class="gt_row gt_right">-4.715296</td>
<td headers="slide" class="gt_row gt_center">7766130076</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506581</td>
<td headers="num" class="gt_row gt_left">2033_B</td>
<td headers="sex" class="gt_row gt_left">f</td>
<td headers="x" class="gt_row gt_right">1.1236156</td>
<td headers="y" class="gt_row gt_right">0.10000322</td>
<td headers="missing" class="gt_row gt_right">0.0009905778</td>
<td headers="u" class="gt_row gt_right">12.17086</td>
<td headers="m" class="gt_row gt_right">12.72962</td>
<td headers="cellpc" class="gt_row gt_right">-0.092658850</td>
<td headers="PC1" class="gt_row gt_right">-27.755083</td>
<td headers="PC2" class="gt_row gt_right">14.255071</td>
<td headers="PC3" class="gt_row gt_right">-2.0908121</td>
<td headers="PC4" class="gt_row gt_right">8.634156</td>
<td headers="PC5" class="gt_row gt_right">6.093985</td>
<td headers="slide" class="gt_row gt_center">7766130076</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506586</td>
<td headers="num" class="gt_row gt_left">2041_B</td>
<td headers="sex" class="gt_row gt_left">m</td>
<td headers="x" class="gt_row gt_right">0.7641103</td>
<td headers="y" class="gt_row gt_right">0.80187438</td>
<td headers="missing" class="gt_row gt_right">0.0002827107</td>
<td headers="u" class="gt_row gt_right">12.21493</td>
<td headers="m" class="gt_row gt_right">12.55075</td>
<td headers="cellpc" class="gt_row gt_right">0.162721440</td>
<td headers="PC1" class="gt_row gt_right">3.698257</td>
<td headers="PC2" class="gt_row gt_right">-7.654752</td>
<td headers="PC3" class="gt_row gt_right">-25.4875983</td>
<td headers="PC4" class="gt_row gt_right">-2.548412</td>
<td headers="PC5" class="gt_row gt_right">5.206511</td>
<td headers="slide" class="gt_row gt_center">7766130076</td></tr>
    <tr><td headers="id" class="gt_row gt_left">GSM1506587</td>
<td headers="num" class="gt_row gt_left">2032_B</td>
<td headers="sex" class="gt_row gt_left">f</td>
<td headers="x" class="gt_row gt_right">1.1346765</td>
<td headers="y" class="gt_row gt_right">0.09581952</td>
<td headers="missing" class="gt_row gt_right">0.0009661991</td>
<td headers="u" class="gt_row gt_right">12.16930</td>
<td headers="m" class="gt_row gt_right">12.75760</td>
<td headers="cellpc" class="gt_row gt_right">0.022304245</td>
<td headers="PC1" class="gt_row gt_right">-27.666525</td>
<td headers="PC2" class="gt_row gt_right">7.826920</td>
<td headers="PC3" class="gt_row gt_right">-4.8620121</td>
<td headers="PC4" class="gt_row gt_right">-8.016373</td>
<td headers="PC5" class="gt_row gt_right">-7.513578</td>
<td headers="slide" class="gt_row gt_center">7766130076</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<p><strong>Figure 3: Coefficient boxplots from linear modeling</strong></p>
<p><img src="coefficient_predictors.png" /></p>
<p><strong>Figure 4: R squared values from linear modeling</strong></p>
<p><img src="rsq.png" /></p>
<p><strong>Figure 5: Fitted values SDs vs.RMSEs from linear modeling</strong></p>
<p><img src="sdvsrmse.png" /></p>
<h2 id="code">Code</h2>
<p>All of the code for this project can be seen in cleaner formatting in the other pages linked at the
top of the website. Here is a <strong>cat</strong> printout of the 3 rmarkdown code files.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>---
title: &quot;Get Methylation Data&quot;
description: |
  Acquiring DNA methylation data and corresponding phenotype information
author:
  - name: Jonah Fisher
    url: https://github.com/JonahF95
    affiliation: Harvard T.H. Chan Department of Biostatistics
    affiliation_url: https://www.hsph.harvard.edu/biostatistics/
date: &quot;`r Sys.Date()`&quot;
output: 
  distill::distill_article:
    toc: true
    toc_depth: 6
    toc_float: true
    css: toc-styles.css
    self_contained: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = T, eval = F)

library(tidyverse)
library(data.table)
library(rvest)
library(gt)
```

# Get data

## Read in html page for sample list and pull replicate pairs

```{r get data together}
url &lt;- &quot;https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE61496&quot;
l &lt;- read_html(url)
l &lt;- l %&gt;% html_text %&gt;% str_split(&quot;\n&quot;) %&gt;% unlist
idx &lt;- str_detect(l, &quot;_[A|B|C|D|E]&quot;) %&gt;% which

dat &lt;- data.table(
  id = l[idx - 1],
  num = l[idx]
)

dat[, c(&quot;num&quot;, &quot;orig&quot;) := tstrsplit(num, &quot;_&quot;)]
setkey(dat, num)
fwrite(dat, &quot;origdat.csv&quot;)

gt(dat) %&gt;% gtsave(&quot;origdat.png&quot;)
```

## Get urls for raw files

There&#39;s a similar FTP address for the files that we can plug into a looping function
which takes the GSM identifier of the file and downloads the corresponding idat

```{r get idats}
if(!dir.exists(&quot;idats&quot;)){
  dir.create(&quot;idats&quot;)
}

#Where this series is located
repourl &lt;- &quot;https://ftp.ncbi.nlm.nih.gov/geo/samples/GSM1506nnn/&quot;

if(length(list.files(&quot;idats&quot;)) &lt; dat[, 2*length(id)]){ #A tiny bit hackish control flow
  for(i in dat[, id]){
  #Need to grab more info on name of sample to download
    ftplines &lt;- paste0(repourl, i, &quot;/suppl/&quot;) %&gt;% readLines() 
  
  #Get red and green idat file locations
    idatnames &lt;- ftplines[str_detect(ftplines, &quot;\\.idat\\.gz&quot;)] %&gt;% tstrsplit(&#39;\\&quot;&#39;, keep = 2) %&gt;% unlist
      paste0(repourl, i, &quot;/suppl/&quot;, idatnames[[1]]) %&gt;% 
      download.file(destfile = paste0(&quot;idats/&quot;,idatnames[[1]]))
    
      paste0(repourl, i, &quot;/suppl/&quot;, idatnames[[2]]) %&gt;% 
      download.file(destfile = paste0(&quot;idats/&quot;,idatnames[[2]]))
  }
}
```

## Pull information on biological sex for qc check

All samples for this study have have bio sex listed on the website after a uniform pattern
of &quot;sex, 1=m, 2=f: [number]&quot; which we can use to match to web scraped results.  

```{r, eval = F}
s &lt;- readLines(&quot;https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM1506327&quot;)
biosex &lt;- map(dat[, id], function(acc){
  readLines(paste0(&quot;https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=&quot;, acc)) %&gt;%
  str_extract(&quot;sex, 1=m, 2=f: \\d&quot;) %&gt;%
  .[!is.na(.)] %&gt;% 
  str_split(&quot;&quot;) %&gt;% 
  unlist() %&gt;% 
  tail(n=1)
})

dat[, sex := c(&quot;m&quot;, &quot;f&quot;)[unlist(biosex) %&gt;% as.numeric]]

fwrite(dat, &quot;samplesheet.csv&quot;)
```













---
title: &quot;Quality Control&quot;
description: |
  Quality control on the DNA methylation dataset
author:
  - name: Jonah Fisher
    url: https://github.com/JonahF95
    affiliation: Harvard T.H. Chan Department of Biostatistics
    affiliation_url: https://www.hsph.harvard.edu/biostatistics/
date: &quot;`r Sys.Date()`&quot;
output: 
  distill::distill_article:
    toc: true
    toc_depth: 6
    toc_float: true
    css: toc-styles.css
    self_contained: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = F)

library(tidyverse)
library(data.table)
library(ewastools)
library(ggsci)
library(matrixStats)

theme_set(theme_bw())
```

```{r load in data}
dat &lt;- fread(&quot;samplesheet.csv&quot;)

if(!dir.exists(&quot;pp&quot;)){
  dir.create(&quot;pp&quot;)
}
```

```{r read in idats, warning = F}
if(!file.exists(&quot;pp/meth.rds&quot;)){
  idats &lt;- list.files(&quot;idats/&quot;, full.names = T, pattern = &quot;\\.idat.gz$&quot;) %&gt;%
    str_remove(&quot;_(Grn|Red)\\.idat\\.gz&quot;) %&gt;%
    unique 

  indmatch &lt;- match(dat[, id], idats %&gt;% str_extract(&quot;GSM[\\d]*&quot;))
  idats &lt;- idats[indmatch]

  meth &lt;- read_idats(idats) %&gt;% detectionP
  stopifnot(dat[, id] == str_extract(meth$meta$sample_id, &quot;GSM[\\d]*&quot;))
  saveRDS(meth, &quot;pp/meth.rds&quot;)
}
```

```{r preprocess}
#Get SNP probes for genotyping
meth &lt;- readRDS(&quot;pp/meth.rds&quot;)
mani &lt;- ewastools:::manifest_450K
snps &lt;- mani[probe_type == &quot;rs&quot;, probe_id]
geno &lt;- call_genotypes(meth %&gt;% mask(0.01) %&gt;% dont_normalize %&gt;% .[snps,])

dat[, c(&quot;x&quot;, &quot;y&quot;) := check_sex(meth)]

dat[, missing := colMeans(meth$detP, na.rm = T)]

dat[, u := colMedians(meth$U, na.rm = T) %&gt;% log2]
dat[, m := colMedians(meth$M, na.rm = T) %&gt;% log2]
```

## Sex check

Check that reported biological sex is concordant with methylation chromosome
intensity. Below plot shows that this is the case and that there are no issues
between reported and observed

```{r check reported sex}
ggplot(dat, aes(x = x, y = y, color = sex)) +
  geom_point(size = 1.5) +
  labs(x = &quot;X chromosome intensity&quot;, y= &quot;Y chromosome intensity&quot;, color = &quot;Reported sex&quot;) +
  theme(legend.position = &quot;bottom&quot;) +
  scale_color_aaas()

ggsave(&quot;sexcheck.png&quot;)
```

## Methylation intensity

```{r methylation intensity}
ggplot(dat, aes(x = m, y = u)) +
  geom_point() + 
  labs(x = &quot;Methylated intensity&quot;, y = &quot;Unmethylated intensity&quot;,
       title = &quot;Median intensities on log2 scale&quot;)
```

## Average detection P failure

```{r detp fail}
ggplot(dat, aes(x = missing)) +
  geom_histogram(color = &quot;black&quot;, fill = &quot;grey&quot;, bins = 4) +
  labs(x = &quot;Average probe failure for sample&quot;)
```

## Check genotyping agreement

The following function uses the expression from SNP probes to infer genotypes
and check for genetic relatedness. We see that many of our technical replicate
pairs appear to be duplicates of other technical replicate pairs. They are in fact 
from **monozygotic twins** and not from the same individual which is why
it looks like we erroneously have duplicate samples listed as from different 
people.

```{r genotype agreement}
check_snp_agreement(geno, dat[, num], dat[, id])
```

# QC with beta methylation matrix

```{r get beta}
beta &lt;- meth %&gt;% dont_normalize()
```


## Cell proportions

```{r cell type proportions}
cells &lt;- estimateLC(beta, ref = &quot;Salas&quot;)
cellpc1 &lt;- prcomp(cells)$x[, 1]
dat[, cellpc := cellpc1]
```

## Principal components

```{r pcs on beta}
whichna &lt;- which(is.na(beta), arr.ind = T)
beta[whichna] &lt;- rowMeans(beta, na.rm = T)[whichna[, 1]]
pcs &lt;- beta %&gt;% t %&gt;% prcomp
dat &lt;- data.table(dat, pcs$x[, 1:5])
```

Surprisingly no real relationship in the cell pell principal component and 
general expression principal component

```{r plot pcs}
ggplot(dat, aes(PC1, PC2, 
                color = cut(cellpc1, 3) %&gt;% as.factor %&gt;% as.integer %&gt;% as.factor)) +
  geom_point() +
  labs(color = &quot;Tertile of cell PC&quot;) +
  theme(legend.position = &quot;bottom&quot;) +
  scale_color_aaas()
```

## PCS by slide

The technical replicate pairs are plated next to each other which means
they aren&#39;t subject to batch effects as much. This can be good or bad depending
on how you look at it. It will make the concordance between these pairs
to be artificially higher than concordance between different plated pairs.

```{r pcs with slide}
dat[, slide := tstrsplit(colnames(beta), &quot;_&quot;, keep = 2)]

ggplot(dat, aes(x = PC1, y = PC2, color = as.factor(slide))) +
  geom_point() +
  labs(color = &quot;Slide&quot;) +
  scale_color_aaas()

ggsave(&quot;pcs_by_slide.png&quot;)
```

```{r save dat}
fwrite(dat, &quot;pdqc.csv&quot;)
```



---
title: &quot;Analysis&quot;
description: |
  A new article created using the Distill format.
author:
  - name: Jonah Fisher
    url: https://github.com/JonahF95
    affiliation: Harvard T.H. Chan Department of Biostatistics
    affiliation_url: https://www.hsph.harvard.edu/biostatistics/
date: &quot;`r Sys.Date()`&quot;
output: 
  distill::distill_article:
    toc: true
    toc_depth: 6
    toc_float: true
    css: toc-styles.css
    self_contained: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(tidyverse)
library(data.table)
library(ggsci)
library(ewastools)
library(caret)
library(bnstruct)

theme_set(theme_bw())
```

# Load in qc data

```{r load data}
dat &lt;- fread(&quot;pdqc.csv&quot;)
meth &lt;- readRDS(&quot;pp/meth.rds&quot;)
```

# Create matrix of predictors and get beta matrix

M values are a log transformation of the beta methylation values. Log transformed
gives them a better distribution. Instead of ranging from 0-1 as in beta values
the 0.5 value becomes a 0 for m values and higher/lower levels of methylation become
positive/negative respectively.

```{r matrix of predictors}
# Predictor matrix to perform PCA on
xmat &lt;- do.call(&quot;rbind&quot;, list(meth$ctrlG, meth$ctrlN, meth$ctrlR)) %&gt;% t
colnames(xmat) &lt;- c(paste0(&quot;ctrlg&quot;, 1:850), paste0(&quot;ctrln&quot;, 1:850), paste0(&quot;ctrlr&quot;, 1:850))
missmat &lt;- which(is.na(xmat), arr.ind = T)
xmat[missmat] &lt;- rowMeans(xmat, na.rm = T)[missmat[, 1]]
xpc &lt;- prcomp(xmat)

#M values for outcome
m &lt;- meth %&gt;% dont_normalize() %&gt;% wateRmelon::Beta2M()
centm &lt;- m %&gt;% t %&gt;% scale(scale = F) %&gt;% t
```

# Linear modeling

The simplest form to start is with linear modeling. Principal components 1-10 of
the predictor matrix is used to predict the mean centered DNA methylation
expression

```{r predict values}
set.seed(260)
irow &lt;- sample(65:nrow(centm), size = 1000)
lmout &lt;- list()
for(i in irow){
  lmout[[paste0(&quot;row&quot;, i)]] &lt;- lm(y ~ ., data = data.table(y = centm[i,], x = xpc$x[, 1:10]))
}
```

## Pull out different coefficients and significance

We look to see if there&#39;s any consistency between the coefficients and the statistical
significance of each of the 10 PCA predictors

### Coefficients

```{r get coefficients}
coefdt &lt;- map(lmout, ~coef(.x)[2:11]) %&gt;% do.call(&quot;rbind&quot;, .) %&gt;% data.table
colnames(coefdt) &lt;- str_extract(colnames(coefdt), &quot;PC\\d*&quot;)
coefdt &lt;- melt(coefdt)

ggplot(coefdt, aes(x = variable, y = value)) +
  geom_boxplot() +
  geom_hline(linetype = &quot;dashed&quot;, yintercept = 0) +
  labs(x = &quot;Predictor&quot;, y = &quot;Coefficient distribution&quot;)
ggsave(&quot;coefficient_predictors.png&quot;)

#Only PC1/PC2 seems to have coefficients significantly different from 0 consistently
t.test(coefdt[variable == &quot;PC1&quot;, value])
t.test(coefdt[variable == &quot;PC2&quot;, value])

coefdt[, t.test(value), by = variable]
```

### Significance

```{r get significance}
sigdt &lt;- map(lmout, ~summary(.x)$coefficients[-1, 3]) %&gt;% do.call(&quot;rbind&quot;, .) %&gt;% data.table
colnames(sigdt) &lt;- str_extract(colnames(sigdt), &quot;PC\\d*&quot;)
sigdt &lt;- melt(sigdt)

ggplot(sigdt, aes(x = variable, y = value)) +
  geom_boxplot() +
  geom_hline(lty = &quot;dashed&quot;, yintercept = 0) +
  labs(x = &quot;Predictor&quot;, y = &quot;Test statistic distribution&quot;)
ggsave(&quot;tstat.png&quot;)

# t.test(sigdt[variable == &quot;PC1&quot;, value])
# t.test(sigdt[variable == &quot;PC2&quot;, value])
sigdt[, t.test(value), by = variable]
```

### R squared

There are fairly high r2 values from these models

```{r get r2}
r2 &lt;- map(lmout, ~summary(.x)$r.squared) %&gt;% data.table

ggplot(r2, aes(x = unlist(.))) +
  geom_histogram(bins = 20, color = &quot;black&quot;, fill = &quot;grey&quot;) +
  labs(x = &quot;Multiple R2 values&quot;)
ggsave(&quot;rsq.png&quot;)

```


## RMSE

```{r get rmse for the models}
map(lmout, ~sd(fitted(.x))) %&gt;% unlist -&gt; sds
map(lmout, ~sqrt(mean(.$residuals^2))) %&gt;% unlist -&gt; rmses

formse &lt;- data.table(sds = sds, rmses = rmses)
formse[, mean(sds)]
formse[, mean(rmses)]

ggplot(formse, aes(x = sds, y = rmses)) +
  geom_point() +
  coord_cartesian(xlim = c(0, 4), ylim = c(0, 4)) +
  geom_smooth(method = &quot;lm&quot;) +
  labs(x = &quot;SDs of fitted values&quot;, y = &quot;RMSE of model&quot;)
ggsave(&quot;sdvsrmse.png&quot;)
```</code></pre>
</div>
<h2 id="references">References</h2>
<p>Tan Q, Frost M, Heijmans BT, von Bornemann Hjelmborg J, Tobi EW, Christensen K, Christiansen L. Epigenetic signature of birth weight discordance in adult twins. BMC Genomics. 2014 Dec 4;15(1):1062. doi: 10.1186/1471-2164-15-1062. PMID: 25476734; PMCID: PMC4302120.</p>
<p>Timothy J. Triche, Jr, Daniel J. Weisenberger, David Van Den Berg, Peter W. Laird, Kimberly D. Siegmund, Low-level processing of Illumina Infinium DNA Methylation BeadArrays, Nucleic Acids Research, Volume 41, Issue 7, 1 April 2013, Page e90, <a href="https://doi.org/10.1093/nar/gkt090" class="uri">https://doi.org/10.1093/nar/gkt090</a></p>
<p>Heiss, J., Just, A. Identifying mislabeled and contaminated DNA methylation microarray data: an extended quality control toolset with examples from GEO. Clin Epigenet 10, 73 (2018). <a href="https://doi.org/10.1186/s13148-018-0504-1" class="uri">https://doi.org/10.1186/s13148-018-0504-1</a></p>
<p><a href="https://jhelvy.github.io/distillery/" class="uri">https://jhelvy.github.io/distillery/</a>  For various helpful tips in the development of this website format.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
